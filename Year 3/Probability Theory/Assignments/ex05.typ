#import "../../../src/article.typ": *
#show: article.with(
  title: [ פתרון מטלה 05 --- תורת ההסתברות 1, 80420 ],
  signature: [#align(center)[#image("../../../src/duck.png", width: 30%, fit: "contain")]],
)

#question()
בקופה $n$  מטבעות.\
נניח ששני שחקנים מטילים קובייה בלתי־תלויה בכל סיבוב, כאשר ההתפלגות של הקובייה היא
$ PP(1)=PP(2)=PP(3)=PP(4)=1/5, wide PP(5)=PP(6)=1/10 $
מי שמקבל את הערך הגבוה ביותר בהטלה זוכה במטבע אחד מן הקופה.\
אם שני השחקנים מקבלים ערכים שווים – אף שחקן אינו מקבל מטבע.

#subquestion()
נמצא את התפלגות מספר המטבעות שכל אחד מהשחקנים מרוויח בסוף המשחק.

#solution[
  נסמן ב־$Y$ ו־$Z$ את תוצאות ההטלה של השחקן הראשון והשני בהתאמה.\
  נגדיר $X_i$ המשתנה המקרי שהשחקן הראשון זכה במטבע ה־$i$ ובהתאם $X = sum_(k=1)^n X_i$, סך הזכיות של המשתתף הראשון.
  אז
  $
    PP(X_i = 1) = PP(Y>Z) = sum_(k=1)^6 PP(Y>Z, Z=k) = PP(Y>Z, Z=1) + dots.h.c + PP(Y>Z, Z=6) \
    = underbrace(3/5 dot.op 1/5 + 2/10 dot.op 1/5, =PP(Y>Z, Z=1)) + underbrace(2/5 dot.op 1/5 + 2/10 dot.op 1/5, PP(Y>Z, Z=2)) + underbrace(1/5 dot.op 1/5 + 2/10 dot.op 1/5, PP(Y>Z, Z=3)) + underbrace(2/10 dot.op 1/5, PP(Y>Z, Z=4)) + underbrace(1/10 dot.op 1/10, PP(Y>Z, Z=5)) + underbrace(0 dot.op 1/5, PP(Y>Z, Z=6)) = 41/100
  $
  יש לנו משתנה מקרי עם $n$ ניסיונות והסתברות הצלחה $p=0.41$ וזה בידיוק לפי הגדרה התפלגות בינומית.
]

#subquestion()
נחשב את ההסתברות לקבלת תוצאת תיקו בהטלה מסויימת.

#solution[
  מהסימטרייה של כל משתתף לנצח בסיבוב, ומהגדרת המשלים נקבל שההסתברות לקבלת תוצאת תיקו בהטלה מסויימת היא $1-0.41 dot.op 2 = 1-0.82 = 0.18$.
]

#subquestion()
נחשב את ההסתברות שמספר הסיבובים הכולל במשחק יהיה לכל היותר $n+1$.

#solution[
  יש לנו לכל הפחות $n$ סיבובים ולכן יש שלוש אפשרויות: או שיש שחקן שזכה בכל ה־$n$ סיבובים הראשונים, או שהיו $n+1$ סיבובים ובסיבוב ה־$1<=k<=n$, משתתף אחד זכה ובשאר המשתתף השני זכה, או שבמקום שהמשתתף השני זכה באחד הסיבובים בידיוק יהיה שבסיבוב אחד בידיוק היה לנו תיקו.\
  נגדיר משתנה מקרי $T$ – מספר תוצאות התיקו שהיו, כאשר ההסתברות לתיקו לפי הסעיף הקודם מתפלג ברנולי עם פרמטר $0.18$, ויש לנו או תיקו אחד או אפס תיקו.\
  נגדיר $W_i$ להיות המשתנה המקרי שאומר שהסיבוב ה־$i$ נגמר בניצחון ולפי סעיף א' זה מתפלג ברנולי עם פרמטר $0.41$.\
  נסמן ב־$W$ המאורע שיהיו $k$ סיבובים במשחק, כלומר $PP(W=k) = PP(sum_(i=1)^k W_i = n)$ כלומר לפי מה שראינו בהרצאה, $W~Bin(0.82)$  ולכן
  $ PP(W<= n+1) = PP(W<n) + PP(W=n) + PP(W=n+1) = 0 + 0.82^n + binom(n+1, n) 0.82^n dot.op 0.18 $
]

#question()
יהיו $X~Bin(n, p)$ ו־$Y~Bin(n, 1-p)$ ונוכיח $n-X =^d Y$.

#proof[
  כלומר, נרצה להראות $(n-X)~Bin(n, 1-p)$. מהגדרה מתקיים
  $
    PP(n-X = l)=PP(X=n-l)=_(X~Bin(n, p)) binom(n, n-l) p^(n-l) (1-p)^(n-(n-l)) =_(binom(n, l)=binom(n, n-l)) binom(n, l) p^(n-l) (1-p)^l
  $
  כלומר $(n-X)~Bin(n, 1-p)$.
]

#question()
יהיו $X_i ~ Ber(p), Z_i ~ Ber(q)$ משתנים מקריים בלתי־תלויים. עבור $i in [n]$ נגדיר
$ Y_i = X_i Z_i, wide X = sum_(i=1)^n X_i, wide Y = sum_(i=1)^n Y_i $

#subquestion()
נראה כי $X~Bin(n, p), Y~Bin(n, p q)$ וכן שלכל $0<=m<=n$ מתקיים
$ Y bar {X=m} ~ Bin(m, q) $

#proof[
  בהרצאה ראינו $X~Bin(n, p)$, נשחזר את ההוכחה לשלמות: יהי $k in {0, dots.h, n}$ ונסמן $Y = sum_(i in [n]) X_i$ וכן נסמן $A_k colon.eq {(x_1, dots.h, x_n) in {0,1}^n bar sum_(i in [n]) X_i = k}$ וקומבינטורית אנחנו יודעים שמתקיים  $abs(A_k) = binom(n, k)$, אז
  $
    PP(Y=k) = sum_(x in A_k) PP(X=x)=_"אי־תלות" sum_(x in A_k) (product_(i in [n]) PP(X_i = x_i)) = binom(n, k) p^k (1-p)^(n-k)
  $
  כלומר $Y~Bin(n, p)$.\
  נעבור להראות $Y~Bin(n, p q)$ נבחין שמתקיים לכל $i$ עם האי־תלות הנתונה:
  $
    PP(Y_i=k) = PP(X_i Z_i=k) = mycases(PP(X_i=1)PP(Z_i=1), k=1, PP(X_i=1)PP(Z_i=0)+PP(X_i=0)PP(Z_i=1)+PP(X_i=0)PP(Z_i=0), k=0, PP(X_i=k)PP(Z_i=k), "אחרת") \
    = mycases(p q, k=1, p(1-q)+q(1-p)+(1-q)(1-p), k=0, 0, "אחרת") = mycases(p q, k=1, 1-p q, k=0, 0, "אחרת")
  $
  כאשר המקרה של "האחרת" נובע מהתומך של משתנה ברנולי ולכן $Y_i ~ Ber(p q)$ ובפרט מהטענה לעיל, $Y ~ Bin(n, p q)$.\
  נשאר להראות $Y bar {X=m} ~ Bin(m, q)$:  לכל $0<=t<=n$ מתקיים $PP(Y=t bar X=m) = PP(Y=t, X=m)/PP(X=m)$.\
  ${X=m}$ שקול ללהגיד שיש $j_1, dots.h, j_m in [n]$ כך שלכל אחד מהם, $X_(j_i)=1$ ולשאר $0$.\
  בשביל ${Y=t}$ יש לנו $k_1, dots.h., k_t$ שהם ב־$j_1, dots.h, j_m$ ובאינדקסים אלו גם $Z_i$ מקבל $1$ ובשאר $0$.\
  אז יש לנו $binom(n, m)$ לבחירת אינדקסים ה־$j$ ו־$binom(m, t)$ לבחירת ל־$Z_i$־ים שיקבלו $1$ מתוך קבוצת האינדקסים של $j$־ ומהאי תלות נקבל
  $
    PP(Y=t bar X=m)=PP(Y=t, X=m)/PP(X=m)= (binom(n, m)p^m (1-p)^(n-m) binom(m, t) q^t (1-q)^(n-m))/(binom(n, m) p^m (1-p)^(n-m)) = binom(m, t) q^t (1-q)^(n-m) \
    ==>Y bar {X=m} ~ Bin(m, q)
  $
]

#pagebreak()

#subquestion()
נראה כי אם עבור $0<=m<=n$ מתקיים $W bar {X=m}~Bin(m, q)$ אז $W~Bin(n, p q)$.

#proof[
  נרצה להשתמש בנוסחת ההסתברות השלמה
  $ PP(Y=k) = sum_(m=k)^n PP(Y=k bar X=m)PP(X=m) $
  אז
  $
               PP(Y=k) & =sum_(m=k)^n binom(m, k) q^k (1-q)^(m-k) binom(n, m)p^m (1-p)^(n-m) \
                       & =_((star)) q^k binom(n, k) sum_(m=k)^n binom(n-k, m-k) (p q)^k (1-p)^(n-m)(1-q)^(m-k) \
                       & =q^k binom(n, k)p^k (1-p)^(n-k) sum_(m=k)^n binom(n-k, m-k) (p(1-q))^(m-k) \
                       & =q^k binom(n, k) p^k (1-p)^(n-k) sum_(j=0)^(n-k) binom(n-k, j) (p(1-q))^j \
                       & = q^k binom(n, k) p^k (1-p)^(n-k)=binom(n, k) (p q)^k (1-p q)^(n-k) \
    ==> Y~ Bin(n, p q)
  $
  כאשר $(star)$ נובע מכך $binom(n, m)binom(m, k)=binom(n, k)binom(n-k, m-k)$.
]

#question()
יהיו $X,Y ~ Geo(p)$ משתנים מקריים בלתי־תלויים.

#subquestion()
נחשב את ההתפלגות של $min {X,Y}$.

#solution[
  בהרצאה ראינו שמשתנה מקרי נתמך על השלמים מתפלג $Geo(p)$ אם ורק אם לכל $n in NN$ מתקיים $PP(Z>n)=(1-p)^n$, אז בפרט מתקיים
  $
    PP(X>=n)=sum_(m=n)^infinity PP(X=m) = sum_(m=n)^infinity (1-p)^(m-1) p = p sum_(m=n+1)^infinity (1-p)^m =_"טור הנדסי" p dot.op ((1-p)^(n+1)-0)/(1-(1-p)) = (1-p)^(n+1)
  $
  כאשר מהיות $p in (0,1]$ מתקיים $lim_(m arrow.r infinity) (1-p)^m = 0$.\
  בפרט מתקיים
  $ PP(min{X,Y}>=k)=PP(X>=k, Y>=k) =_"אי־תלות" PP(X>=k)PP(Y>=k) = (1-p)^(k-1) (1-p)^(k-1) = (1-p)^(2k-2) $
  נשאר אם־כך לחשב
  $
    PP(min{X,Y}=k) = PP(min{X,Y}>=k)-PP(min{X,Y}>=k+1) = (1-p)^(2k-2)-(1-p)^(2k) \
    = (1-p)^(2k) ((1-p)^(-2)-1) = (1-p)^(2k) (2p-p^2)/(1-p)^2 = (1-p)^(2k-2)(2p-p^2)
  $
]

#subquestion()
נחשב את ההתפלגות של $X+Y$.

#solution[
  נגדיר משתנה מקרי חדש $Z=X+Y$ ונשתמש בקונבולוציה:
  $
    PP(Z=z)=PP(X+Y=z) = sum_(k=1)^(z-1) PP(X=k, Y=z-k)=_"אי־תלות" sum_(k=1)^(z-1) PP(X-k)PP(Y=z-k) \
    = sum_(k=1)^(z-1) (p(1-p)^(k-1))(p(1-p)^(z-k-1)) = sum_(k=1)^(z-1) p^2 (1-p)^(z-2) = p^2 (1-p)^(z-2) sum_(k=1)^(z-1) 1 = p^2 (1-p)^(z-2)(z-1)
  $
]

#subquestion()
נחשב את ההתפלגות של $X-Y$.

#solution[
  שוב עם קונבולוציה
  $ PP(X-Y=z)=sum_(k=1)^infinity PP(X=k+z, Y= k)=_"אי־תלות" sum_(k=1)^infinity PP(X=k+z)PP(Y=k) $
  כאשר האינדקסי סכימה נובעים מכך ש־$X=Z+Y$  ולכן הערכים האפשריים עבור $Y$ הם עבור $k>=1$ כי משתנה מקרי גיאומטרי ובאותו אופן עבור $X$ צריך להתקיין $z+k>=1 ==>k>=1-z$.\
  אז האינדקס ההתחלתי לסכימה יהיה $max {1, 1-z}$ ומהגדרת המשתנה המקרי הגיאומטרי יהיה חיבי להתקיים $k=1$ להתחלה.\
  כעת יש שלוש אופציות:
  $ X>Y wide X<Y wide X=Y ==>_"בהתאמה" z>=1, wide z<=-1, wide z=0 $
  עבור $z=0$ זה המקרה הדי טריוויאלי
  $
    PP(X-Y=0) = PP(X=Y) = sum_(k=1)^infinity PP(X=k)PP(Y=k)= sum_(k=1)^infinity (p(1-p)^(k-1))(p(1-p)^(k-1))=p^2 (1-p)^(-2) sum_(k=1)^infinity (1-p)^2k \
    =_"טור הנדסי" p^2 (1-p)^(-2) (1-p)^2/(p(2-p))=p/(2-p)
  $
  כעת עבור $z>=1$ נקבל
  $
    PP(X-Y=z) = sum_(k=1)^infinity (p(1-p)^(z+k-1))(p(1-p)^(k-1)) = p^2 sum_(k=1)^infinity (1-p)^(z+2k-2) = p^2 (1-p)^(z-2) sum_(k=1)^infinity (1-p)^(2k) \
    =_"טור הנדסי" p^2(1-p)^(z-2) (1-p)^2/(p(2-p)) = (p(1-p)^z)/(2-p)
  $
  עבור $z<=-1$ נשים לב שמתקיים
  $ PP(X-Y=z) =_(m=-z) PP(X-Y=-m) = PP(Y-X=m) $
  אבל $ PP(Y-X=m) = PP(X-Y=m) $
  מטעמי סימטרייה, ולכן עבור $z<=-1$ נקבל מהמקרה הקודם
  $ PP(X-Y=z) PP(Y-X=-z) = (p(1-p)^(-z))/(2-p) $
  נשים לב שבעצם בכל המקרים קיבלנו את אותה התוצאה, כלומר לכל $k in ZZ$ מתקיים
  $ PP(X-Y=k) = (p(1-p)^abs(k))/(2-p) $
]

#subquestion()
נחשב את ההתפלגות של $max{X,Y}$.

#solution[
  ראשית נשים לב מהגדרת המקסימום שמתקיים
  $ PP(max{X,Y}<=k) = PP(X<=k, Y<=k)=_"אי־תלות" PP(X<=k)PP(Y<=k)=(1-(1-p)^k)^2 $
  ובאופן דומה לסעיפים הקודמים שכן אנחנו נתמכים על הטבעיים
  $ PP(max{X,Y}=k) = PP(max{X,Y}<=k) - PP(max{X,Y}<=k-1)=(1-(1-p)^k)^2-(1-(1-p)^(k-1))^2 $
]

#question()
נגדיר $Y_i$ סדרה של משתנים מקריים בלתי־תלויים שווי התפלגות על $ZZ$ ונגדיר
$ n>=0, space X_n = sum_(i=1)^n Y_i, wide Z = sum_(n=0)^infinity bb(1)_(X_n=0) $
נניח $p colon.eq 1-PP(exists n>0 bar X_n = 0)>0$ ונראה כי $Z~Geo(p)$.

#solution[
  ראשית נשים לב $PP(Z=0)=0$.\
  #todo
]

#question()
נראה כי אם $X~Poi(lambda), Y~Poi(eta)$ בלתי־תלויים אז לכל $n in NN_0 = NN union {0}$ מתקיים
$ (X bar X+Y=n)~Bin(n, lambda/(lambda+eta)) $

#solution[
  #todo
]

#question()
אלקרס וג'וקוביץ משחקים טניס זה מול זה. ההסתברות של אלקרס לנצח במערכה אחת של המשחק היא $2/3$, באופן בלתי־תלוי בתוצאות המערכות הקודמות. השניים משחקים עד אשר אחד מהם זוכה ב־$3$ מערכות.\
מה ההסתברות שאלקרס יזכה במשחק? איך הדבר קשור להתפלגות בינומית?

#solution[
  נסמן ב־$X_i$ את המאורע שאלקרס זכה במערכה ה־$i$ ולפי הנתון $X_i ~ Ber(2/3)$ ולכן מהנתון על האי־תלות נקבל $X = sum_(i=1)^n X_i ~ Bin(n, 2/3)$ כאשר יש לנו $n$ סיבובים.\
  נבחין שאם $n>5$ יש לפחות $3$ נצחונות לאחד מהם ולכן סיימנו, אז מספיק לחשב עד $n=5$ אז
  $
    PP(X>=3) & = PP(X=3)+PP(X=4)+PP(X=5) \
             & =_(X~Bin(n, 2/3)) sum_(k=3)^5 binom(5, k) (2/3)^k (1/3)^(5-k) \
             & = binom(5, 3) (2/3)^3 (1/3)^2+binom(5, 4) (2/3)^4 (1/3)^1 + binom(5, 5) (2/3)^5 (1/3)^0 \
             & = 0.79
  $
]
