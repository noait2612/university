#import "../../../src/article.typ": *
#show: article.with(
  title: [ פתרון מטלה 08 --- תורת ההסתברות 1, 80420 ],
  signature: [#align(center)[#image("../../../src/duck.png", width: 30%, fit: "contain")]],
)

#question()
יהי $1<=n$ ויהי $X ~ Unif({-n, dots.h, n})$.\
נוכיח שאם $f: RR arrow.r RR$ היא פונקציה זוגית (כלומר $f(x)=f(-x)$ לכל $x in RR$), אז המשתנים המקריים $X, f(X)$ הם בלתי־מתואמים ונבחן האם הם בלתי־תלויים.

#proof[
  ראשית נגיד כי שני משתנים מקריים $X,Y$ הם בלתי־מתואמים אם מתקיים
  $ Cov(X, Y)=EE(X Y)-EE(X)EE(Y)=0 $
  ראשית נבחין
  $
    EE(X) = sum_(i in {-n, dots.h.c, n}) i PP(X=i) =_(X ~ Unif({-n, dots.h, n})) sum_(i in {-n, dots.h.c, n}) i/(2n) = 1/(2n) sum_(i in {-n, dots.h.c, n}) i = 0
  $
  ולכן בהכרח יתקיים
  $ Cov(X, Y) = EE(X f(X))- EE(X)EE(f(X)) = EE(X f(X)) $
  נשאר לחשב את $EE(X f(X))$, ניזכר שראינו שאם $Y = f(X)$ אז
  $ EE(Y)=sum_(k in supp) f(k)PP(X=k) $
  ולכן אם נגדיר $g: RR arrow.r RR$ על־ידי $g(X)=X$, אז $g$ היא פונקציה אי־זוגית כי $g(-x)=-x$ לכל $x in RR$.\
  אז $h(X) = g(X) dot.op f(X)$ היא פונקציה אי־זוגית שכן
  $
    h(-X) = g(X) dot.op f(-X) =_("זוגית" f \
    "אי־זוגית" g) -g(X) dot.op f(X) = -X dot.op f(X) = -g(X)
  $
  ולכן אם נסמן $Y=h(X)$
  $
    EE(X f(X)) = EE(Y)=sum_(i in {-n, dots.h.c, n}) h(i) PP(X=i) = sum_(i=-n)^n i f(i) PP(X=i) =_(X ~ Unif({-n, dots.h, n})) 1/(2n+1) sum_(i=-n)^n i f(i) \
    = 1/(2n+1) sum_(i=1)^n (-i f(-i) + i f(i))=_(f(-i)=f(i)) 1/(2n+1) sum_(i=1)^n (-i f(i) + i f(i)) = 0
  $
  אז $X, f(X)$ בלתי־מתואמים.\
  נטען שלא בהכרח שהם בלתי־תלויים: ניקח $f(x)=x^2=Y$ ונניח שהם בלתי־תלויים ולכן צריך להתקיים
  $ PP(X=n, Y=n^2)=PP(X=n)PP(Y=n^2) $
  נשים לב שההסתברות $PP(X=n, Y=n^2)$ זו ההסתברות שגם $X=n$ וגם $Y=n^2$, אבל אם $X=n$ אז בהכרח $Y=n^2$ (כי $Y=f(x)$) אז
  $ PP(X=n, Y=n^2)=PP(X=n)=1/(2n+1) $
  מצד שני
  $
    PP(X=n)PP(Y=n^2)=PP(X=n)PP(X=n "or" X=-n)=_"אי־תלות" PP(X=n)(PP(X=n)+PP(X=-n)) \
    =1/(2n+1) dot.op 2/(2n+1) = 2/(2n+1)^2
  $
  אבל לכל $n in NN$ מתקיים
  $ 1/(2n+1) != 2/(2n+1)^2 $
  ולכן לא בהכרח שהמאורעות בלתי־תלויים.
]

#question()
מטילים באופן בלתי־תלוי מטבע על כל משבצת בלוח משבצות בגודל $n times n$.\
יהי $X_n$ המשתנה המקרי הסופר את מספר הריבועים מהצורה $display(mat(delim: "[", H, H; H, H))$.\
נחשב את התוחלת והשונות של $X_n$ ונראה כי $X_n/EE(X_n) stretch(arrow.r)_(n arrow.r infinity) 1$.

#solution[
  נגדיר את המשתנה המקרי $X_(i,j)$ להיות המשתנה המקרי המציין שבמשבצת ה־$(i, j)$ הטלת המטבע יצאה $H$, אז $X_(i,j) ~ Ber(1/2)$ (המטבע הוגן).\
  נגדיר $Y_(i,j) = X_(i,j) X_(i+1, j) X_(i, j+1) X_(i+1, j+1)$ המשתנה המקרי שאומר שיש לנו ריבוע שכולו $H$ שמתחיל בקורדינאטה $(i,j)$ (כלומר, קורדינאטה זו היא הפינה השמאלית שלו).\
  מהיות ההטלות בלתי־תלויות, $Y_(i,j) ~ Ber(1/2^4)=Ber(1/16)$ וכן $X_n = sum_(1<=i,j<=n-1) Y_(i,j)$.\
  כאשר האינדקסים נובעים מגבולות אפשריים של ריבועים על לוח מסדר $n times n$.\
  מלינאריות התוחלת נקבל
  $ EE(X_n) = EE(sum_(1<=i,j<=n-1) EE(Y_(i,j))) = (n-1)^2 EE(Y_(1,1)) =_(Y_(i,j)~Ber(1/16)) (n-1)^2/16 $
  בשביל חישוב השונות עלינו למצוא את כל החפיפות האפשריות (כמובן שאם שני ריבועים של $H$־ים אינם חופפים אז הם מייצגים הטלות בלתי־תלויות ולכן בלתי־מתואמות).\
  בדומה למטלה הקודמת, יש לנו חפיפה בין שני מרובעים בשתי צורות אפשריות:
  + יש לנו צורת $L$ ולכן חולקים משבצת אחת
    $
      H H T \
      H H H \
      T H H
    $
  + חולקים $2$ משבצות $ H space H space H \
    H space H space H $
  נתייחס קודם למקרה השני כי הוא פשוט יותר, הוא קורה כאשר כל $6$ הקורדינאטות הן הטלה של $H$ כלומר $EE(Y_(i,j) Y_(k, l)) = 1/2^6$ (שכן כמובן משתנה ברנולי נתמך על ${0,1}$ ובריבוע הם אותו הדבר) ולכן $ Cov(Y_(i,j), Y_(k, l)) = 1/64 - 1/16^2 = 1/64 - 1/256 = 3/256 $
  מבחינת כמות חפיפות, יש לנו $(n-1)(n-2)$ חפיפות אופקיות וכן הנחיות ובסך־הכל $2(n-1)(n-2)$ חפיפות כאלו מהסוג הזה.\
  עבור המקרה הראשון, הוא קורה כאשר יש לנו $7$ קורדינאטות שכולן קיבלו $H$, כלומר $EE(Y_(i,j) Y_(k,l)) = 1/2^7$ ולכן $ Cov(Y_(i,j) Y_(k,l)) = 1/128 - 1/256 = 1/256 $
  נשאר לבחון כמה פעמים מקרה כזה קורה:\
  אם יש לנו מרובע שמתחיל ב־$(i,j)$ אז ריבוע שחופף לו בידיוק בקורדינאטה אחת מתחיל ב־$(i+1, j+1)$, כלומר הגבולות שלנו מצטמצמים באחד מהקורדינאטות שאנחנו יכולים לקבל,כלומר יש $(n-2)^2$ אפשרויות כאלו (כמובן צריך לכפול ב־$2$ כי זה רק לחפיפה תחתונה לצורך העניין), ולכן יש לנו $2(n-2)^2$ אפשרויות לחיתוכים של $L$.\
  אם־כך, מנוסחה לחישוב סכום שנויות מהיות
  $
    Var(X_n) = Var(sum_(1<=i,j<=n-1) Var(Y_(i,j)))= sum_(1<=i,j<=n-1) Var(Y_(i,j))+2sum_((i,j)<(k,l)) Cov(Y_(i,j), Y_(k,l))
  $
  ראשית
  $ Y_(i,j) ~ Ber(1/16) ==> Var(Y_(i,j))=1/16 (1-1/16)=15/256 $
  ולכן
  $
    Var(X_n) = (n-1)^2 dot.op 15/256 + 2(2(n-1)(n-2) dot.op 3/256 + 2(n-2)^2 dot.op 1/256) \
    = (15n^2-30n+15)/256 + 2((3n^2-9n+6)/128+(n^2-4n+4)/128) = (15n^2-30n+15)/256 + (4n^2-13n+10)/64 \
    = (15n^2-30n+15)/256 + (4(4n^2-13n+10))/256 = (15n^2-30n+15+16n^2-52n+40)/256 \
    = (31n^2-82n+55)/256
  $
  נשאר להראות $X_n/EE(X_n) stretch(arrow.r)_(n arrow.r infinity) 1$, יהי $epsilon>0$ ונראה כי $PP(abs(X_n/EE(X_n)-1)>=epsilon) stretch(arrow.r)_(n arrow.r infinity) 0$.\
  ממה שמצאנו אודות $Var(X_n)$ נובע כי קיים $C in RR$ כך ש־$Var(X_n) <= C n^2$ ונקבל אם כך
  $
    PP(abs(X_n/EE(X_n)-1)>=epsilon) = PP(abs(X_n - EE(X_n))>=epsilon EE(X_n))<=_"אי־שיוויון צ'בישב" Var(X_n)/(epsilon^2 EE(X_n)^2) <= (C n^2)/(epsilon^2 ((n-1)^2/16)^2) = (16C n^2)/(epsilon^2(n-1)^4) = 0
  $
  שכן יש לנו ביטוי מהצורה
  $ n^2/n^4 = 1/n^2 stretch(arrow.r)_(n arrow.r infinity) 0 $
]

#question()
יהיו $X_1, X_2, dots.h$ משתנים מקריים בלתי־תלויים כך ש־$X_i ~ Ber(1/2)$.\
נגדיר $Y_i = max(X_i, X_(i+1))$ ו־$Z_n = sum_(i=1)^n Y_i$.

#subquestion()
נחשב את התוחלת והשונות של $Z_n$.

#solution[
  ראשית נבחין כי $Y_i in {0,1}$ שכן $X_i ~ Ber(1/2)$ ונפרט את המקרים האפשריים:
  $
    Y_i = 1 <==> {{X_i=X_(i+1)=1}, {X_i=1, =X_(i+1)=0}, {X_i=0, =X_(i+1)=1}} \
    Y_i = 0 <==> {X_i=X_(i+1)=0}
  $
  כלומר $Y_i=0$ אם ורק אם $X_i = X_(i+1)=0$ ו־$Y_i=1$ אם לפחות אחד מ־$X_i, X_(i+1)$ הם $1$.\
  מהאי־תלות אנחנו יכולים להסיק שמתקיים $Y_i = 0$ בהסתברות של $1/4$ ו־$Y_i=1$ בהסתברות של $3/4$, כלומר $Y_i ~ Ber(3/4)$.\
  מלינאריות התוחלת נקבל
  $ EE(Z_n) = EE(sum_(i=1)^n Y_i) = n dot.op EE(Y_1) = (3n)/4 $
  בשביל השונות נשתמש כמובן בנוסחה לחישוב סכום שנויות
  $
    Var(Z_n) = Var(sum_(i=1)^n Var(Y_i))= sum_(i=1)^n Var(Y_i)+2sum_(i<j) Cov(Y_i, Y_j)
  $
  ראשית נבחין מהיות $Y_i ~ Ber(3/4)$
  $ Var(Y_i) = 3/4 (1-3/4) = 3/16 $
  כעת, נבחין כי המאורעות $Y_i, Y_j$ בלתי־תלויים אם $j=i+2$ שכן אז הם ערכים של פונקציות שמייצגות מאורעות בלתי־תלויים.\
  אז המקרה המעניין היחידי עבורו לחשב שונות זה המקרה של $Y_i, Y_(i+1)$:
  $ Cov(Y_i, Y_(i+1))=EE(Y_i Y_(i+1))-EE(Y_i)EE(Y_(i+1)) $
  נשים לב שלחשב את ${Y_i Y_(i+1) = 1}$ יותר קל לחשב עם המשלים, כלומר להוריד את המקרים הרעים: \
  ${Y_i Y_(i+1)=0}$ קורה אם $Y_i = 0$ או $Y_(i+1)=0$ כאשר שניהם קורים אם ורק אם $X_i = X_(i+1)=0$ או $X_(i+1) = X_(i+2)=0$ כלומר אם ורק אם יש לנו את אחת מהשלשות הבאות
  $ (X_i, X_(i+1), X_(i+2)) in {000, 001, 100} $
  נשים לב שכל מאורע כזה הוא מהסתברות של $1/8$, ולכן $PP(Y_i Y_(i+1)=1)=1-3/8=5/8$ ונקבל
  $ Cov(Y_i, Y_(i+1))= 5/8 - (3/4)^2 = 5/8 - 9/16 = 1/16 $
  כלומר הנוסחה שאנחנו מחשבים לפיה היא
  $
    Var(Z_n) = Var(sum_(i=1)^n Var(Y_i))= sum_(i=1)^n Var(Y_i)+2sum_(i=1)^(n-1) Cov(Y_i, Y_(i+1)) = (3n)/16 + (2(n-1))/16 = (5n-2)/16
  $
]

#pagebreak()

#subquestion()
נוכיח שלכל $epsilon>0$ מתקיים $display(lim_(n arrow.r infinity) PP(abs(1/(2n) sum_(i=1)^(2n) Y_i - 3/4)>=epsilon)=0)$.

#proof[
  מהסעיף הקודם אנחנו יכולים להסיק
  $ 2n dot.op 3/4 = EE(Z_(2n)) $
  אז מהגדרת $ Z_n = sum_(i=1)^n Y_i ==> sum_(i=1)^(2n) Y_i = Z_(2n) $
  ולכן נקבל
  $
    Var(Z_(2n))=Var(sum_(i=1)^(2n) Var(Y_i))= sum_(i=1)^(2n) Var(Y_i)+2sum_(i=1)^(2n-1) Cov(Y_i, Y_(i+1)) = (6n)/16 + (2(2n-1))/16 = (10n+2)/16
  $
  ובסך־הכל
  $
    PP(abs(1/(2n) sum_(i=1)^(2n) Y_i - 3/4)>=epsilon) =PP(abs(Z_(2n) - EE(Z_(2n))))>=2n epsilon)<=_("אי־שיוויון צ'בישב") Var(Z_(2n))/(4n^2 epsilon^2) =((10n+2)/16)/(4n^2 epsilon^2) = (10n+2)/(64n^2 epsilon^2) stretch(arrow.r)_(n arrow.r infinity) 0
  $
  מאריתמטיקה של גבולות.
]

#question()
יהיו $X,Y$ משתנים מקריים ב־$L^2$ בעלתי תוחלת $mu_X, mu_Y$ וסטיות תקן $sigma_X, sigma_Y$ בהתאמה. נראה כי
$ min{EE((X-Z)^2) bar Z in Span(1, Y))}=EE((X-Proj_(1,Y) (X))^2) = sigma_X^2 - Cov(X, Y)^2/(sigma_Y^2) $

#proof[#todo]

#question()
#subquestion()
יהי $X$ משתנה מקרי בעל תוחלת $0$ המקיים $abs(X)<=M$ כמעט־תמיד עבור $M>0$. נוכיח שלכל $t in RR$ מתקיים
$ EE(e^(t X))<=exp((M^2t^2)/2) $

#proof[
  נשחזר את ההוכחה מההרצאה בהתאם לשינויים הנדרשים.\
  ראשית מהיות $abs(X)<=M$ מתקיים $-M<=X<=M$ ואם נגדיר את הפונקציה $f(x)=e^(t x)$ כפי שראינו בהרצאה היא פונקציה קמורה.\
  אנחנו רוצים למתוח קו ישר בין $(-M, e^(-t M))$ ולבין $(M,e^(t M))$ בקטע $[-M, M]$, והמשוואה לקו־ישר נתונה על־ידי
  $
    y=(e^(t M)-e^(-t M))/(2M) (x-(-M))+e^(-t M) = x/(2M) (e^(t M)-e^(-t M)) + (e^(t M)-e^(-t M))/2 + e^(- t M) = ((M+x)/(2M)) e^(t M)+ ((M-x)/(2M)) e^(-t M)
  $
  ומקמירות אנחנו יודעים שמתקיים
  $ e^(t x)<=((M+x)/(2M)) e^(t M)+ ((M-x)/(2M)) e^(-t M) $
  נפעיל על הביטוי הזה את התוחלת
  $
    EE(e^(t X)) & <=EE(((M+X)/(2M)) e^(t M)+ ((M-X)/(2M)) e^(-t M)) \
                & =_((star)) ((M+EE(X))/(2M)) e^(t M)+ ((M-EE(x))/(2M)) e^(-t M) \
                & =_((star star)) ((M)/(2M)) e^(t M)+ ((M)/(2M)) e^(-t M) \
                & = 1/2 e^( t M) + 1/2 e^(-t M) \
                & = cosh(t M)
  $
  כאשר $(star)$ נובע מלינאריות התוחלת, $(star star)$ נובע מהיות $EE(X)=0$.\
  אבל בהרצאה ראינו שלכל $t in RR$ מתקיים $cosh(x)=(e^x+e^(-x))/2 <= e^(x^2/2)$ (נובע מטור טיילור), אז בפרט עבור $x=t M$ נקבל
  $ cosh(t M) <= e^((t M)^2/2) = e^((t^2M^2)/2) = exp((t^2M^2)/2) $
  כפי שהתבקשנו להראות.
]

#subquestion()
יהיו $X_1, X_2, dots.h, X_n$ משתנים מקריים בלתי־תלויים ויהיו $M_1, M_2, dots.h, M_n$ מספרים חיוביים כך שלכל $i in [n]$ מתקיים $abs(X_i)<=M_i$ כמעט־תמיד ו־$EE(X_i)=0$.\
נוכיח כי לכל $a>0$ מתקיים
$ PP(X_1 + X_2 + dots.h.c + X_n >= a)<=exp(-a^2/(2M)) $
כאשר $M = M_1 + M_2 + dots.h.c + M_n$.

#proof[
  נסמן $X = sum_(i=1)^n X_i$, אז לכל $t>0$ מתקיים
  $ PP(X<=a) = PP(e^(t X)>=e^(t a))<=_"אי־שיוויון מרקוב" e^(-t a) EE(e^(t X)) $
  מהיות המשתנים בלתי־תלויים
  $
    EE(e^(t X))= product_(i=1)^n EE(e^(t X_i))<=_"סעיף קודם" product_(i=1)^n exp((M_i^2 t^2)/2)=exp(t^2/2 sum_(i=1)^n M_i^2)
  $
  נרצה לחסום בצורה הדוקה יותר ולשים כך נשתמש בעובדה ש־$M = sum_(i=1)^n M_i$ ומהיות כל $M_i > 0$ נקבל
  $ sum_(i=1)^n M_i^2 <= sum_(i=1)^n M_i M = M^2 $
  אזי
  $ EE(e^(t X))<= exp((M^2t^2)/2) $
  ולכן
  $ PP(X<=a)<=e^(-t a) EE(e^(t X)) <= exp(-t a + (M^2 t^2)/2) $
  בדומה להרצאה, כדי למקסם על ערך ה־$t$ נגזור לפי $t$ ונקבל
  $ dif/(dif t) (-t a + (M^2 t^2)/2) = -a + M^2t ==> t = a/M^2 $
  כלומר
  $
    -t a + (M^2 t^2)/2 ==> -a^2/M^2 + cancel(M^2)/2 dot.op a^2/cancel(M^4) = -a^2/M^2+a^2/(2M^2)=-a^2/(2 M^2)
  $
  ולכן
  $ PP(X<=a)<= exp(-a^2/(2M^2)) $
]

#subquestion()
נסיק את אי־שיוויון הופדינג המוכלל: יהיו $X_1, X_2, dots.h, X_n$ משתנים מקריים בלתי־תלויים ויהיו $M_1, M_2, dots.h, M_n$ מספרים חיוביים כך שלכל \ $i in [n]$ מתקיים $abs(X_i-EE(X_i))<=M_i$ כמעט־תמיד.\
נסמן $X = X_1 + dots.h.c + X_n, M = M_1 + dots.h.c + M_n$  אז לכל $a>0$ מתקיים
$ PP(X-EE(X)>=a)<=exp(-a^2/(2M^2)) $

#proof[
  נגדיר $Y_i = X_i - EE(X_i)$ לכל $i in [n]$ אז $Y_1, Y_2, dots.h.c, Y_n$ הם משתנים מקריים בלתי־תלויים כך ש־$EE(Y_i)=0$.\
  נתון כי $abs(Y_i) = abs(X_i - EE(X_i))<=^(a.s) M_i$ ולכן אם נגדיר $Y = sum_(i=1)^n Y_i$ נוכל להשתמש בסעיף הקודם ולקבל
  $ PP(Y>= a)<=exp(-a^2/(2M^2)) ==> PP(X-EE(X)>=a)<= exp(-a^2/(2M^2)) $
  כאשר $==>$ נובע מלינאריות התוחלת, שכן $ Y = sum_(i=1)^n Y_i = sum_(i=1)^n (X_i - EE(X_i)) = sum_(i=1)^n X_i - sum_(i=1)^n EE(X_i) = sum_(i=1)^n X_i - EE(sum_(i=1)^n X_i) = X - EE(X) $
]

#subquestion()
אורנה בוחרת באקראי ובאופן אחיד מספר בין $0$ ל־$10$, דפנה בוחרת באקראי מספר בין $0$ ל־$20$ ודורית בוחרת באקראי מספר בין $0$ ל־$30$, באופן בלתי־תלוי.\
נשתמש בתוצאות הסעיף הקודם כדי לתת חסם מלרע להסתברות שסכום המספרים ששלושתן בחרו נמצא בין $0$ ל־$49$.

#solution[
  נסמן $X_1, X_2, X_3$ המספר שאורנה, דפנה ודורית בחרו בהתאמה ונסמן $X = X_1 + X_2 + X_3$.\
  ניזכר כי אם $Y~Unif([n])$ אז $EE(Y)=(n+1)/2$, הספירה שלנו כוללת את הקצוות ולכן
  $
    EE(X_1) =_(X_1 ~ Unif([11])) 12/2=6, space EE(X_2) =_(X_2 ~ Unif([21])) = 22/2 = 11, space EE(X_3) =_(X_3 ~ Unif([31])) = 32/2 = 16
  $
  לכן כמעט־תמיד מתקיים
  $ abs(X_1 - EE(X_1))<=6, space abs(X_2 - EE(X_2))<=11, space abs(X_3 - EE(X_3))<=16 $
  ומהסעיף הקודם נקבל
  $ PP(X>=50) = PP(X-EE(X)>=17)<= exp(- 17^2/(2(6^2+11^2+16^2))) = exp(-289/826) $
]

#question()
שיכור עומד על ציר המספרים השלמים. הוא מטיל מטבע שנופל על עץ בהסתברות $q$. אם יוצא לו עץ הוא הולך שני צעדים ימינה ואם יוצא לו פלי הוא הולך צד אחד שמאלה. הוא מבצע $n$ הטלות מטבע כאלו באופן בלתי־תלוי. יהי $X_n$ מיקומו אחרי $n$ הצעדים האלו.\
נמצא עבור אילו ערכים של $q$ ניתן לחסום בצורה לא טריוויאלית את $PP(X_n>=0)$ בעזרת אי־שיוויון הופדינג ונמצא מהו החסם שמתקבל.

#solution[#todo]

#question()
עבור $f : NN arrow.r [0,1]$ המקיימת
$ sum_(n=1)^infinity f(n)=a <=infinity $
נגדיר משתנה מקרי $X$ הנתמך על $ZZ without 0$ בעל פונקציית ההתפלגות הנקודתית
$ p_ZZ = f(abs(z))/(2a) $
לכל $N in NN$ ו־$epsilon > 0$ נגדיר
$ p_(N, epsilon) colon.eq PP(abs((sum_(n=1)^N X_n)/N)<=epsilon) $
עבור $X_1, X_2, dots.h, X_n$ בלתי־תלויים ושווי התפלגות ל־$X$.\
נאמר כי $X$ מקיים את מסקנת החוק החלש אם לכל $epsilon>0$ מתקיים $lim_(N arrow.r infinity) p_(N, epsilon) = 1$.\
נראה כי עבור $f(n)=1/(n^2log(n))$ המשתנה $X$ מקיים את מסקנת החוק החלש על־אף שאינו עומד בתנאי משפט החוק החלש ונסיק כי החוק החלש אינו משפט של אם ורק אם.

#proof[#todo]
