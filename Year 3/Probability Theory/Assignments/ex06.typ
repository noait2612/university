#import "../../../src/article.typ": *
#show: article.with(
  title: [ פתרון מטלה 06 --- תורת ההסתברות 1, 80420 ],
  signature: [#align(center)[#image("../../../src/duck.png", width: 30%, fit: "contain")]],
)

#question()
#subquestion()
נפריך את הטענה שאם $X$ משתנה מקרי המוגדר על מרחב הסתברות $(Omega, PP)$ כך ש־$X~U({1,2,3})$ אז $(Omega, PP)$ הוא מרחב הסתברות אחידה.

#proof[
  נגדיר
  $ Omega = {omega_1, omega_2, omega_3, omega_4} $
  ונגדיר
  $ PP({omega_1}) = 1/12, space PP({omega_2})=PP({omega_3})=PP({omega_4})=3/12 $
  זהו אינו מרחב הסתברות אחיד, ואם נגדיר $X:Omega arrow.r {1,2,3}$ על־ידי
  $ X(omega_1) = X(omega_2) = 1, space X(omega_3) = 2, space X(omega_4)=3 $
  אז מתקיים
  $
    PP(X=1) = PP({omega_1, omega_2}) = PP({omega_1})+PP({omega_2}) = 1/6+1/6 = 1/3 \
    PP(X=2) = PP({omega_3})=1/3 \
    PP(X=3) = PP({omega_4}) = 1/3
  $
  ואכן $X~U({1,2,3})$.
]

#subquestion()
נפריך את הטענה שאם $X,Y$ משתנים מקריים בלתי־תלויים ובעלי תומך סופי ומתקיים $EE(abs(X-Y))=0$ אזי $PP(X=Y)=1$.

#proof[
  ניקח את $Omega = {1, -1}$ ונניח שגם $X,Y$ משתנים מקריים בלתי־תלויים כך שמתקיים $X(omega)=omega, Y(omega)=-omega$ ואכן התומך של $X,Y$ סופי גם הוא.
  מצד אחד, מנוסחת התוחלת נקבל
  $EE(abs(X-Y))=0$ אבל $PP(X=Y)=0$.]

#subquestion()
נפריך את הטענה שאם $X$ משתנה מקרי בעל תוחלת אז גם $X^2$ משתנה מקרי בעל תוחלת.

#proof[
  נניח כי $X$ משתנה מקרי הנתמך על הטבעים ונגדיר $PP(X=n)=c/n^3$ עבור $c$ קבוע.\
  מצד אחד, הטור $EE(X)=sum_(n=1)^infinity n dot.op c/n^3$ מתכנס בהחלט ומנגד $EE(X^2)=sum_(n=1)^infinity n^2 dot.op c/n^3 = sum_(n=1)^infinity c/n$ מתבדר.
]

#subquestion()
נוכיח שאם $X$ משתנה מקרי כך ש־$X^2$ בעל תוחלת אז $X$ בעל תוחלת.

#proof[
  $
    EE(X^2) = sum_(s in RR_(>=0)) s PP(X^2=s) = sum_(s in RR_(>=0)) sqrt(s) dot.op sqrt(s) dot.op PP(X in {sqrt(s), -sqrt(s)}) = sum_(s' in RR_(>=0)) s' dot.op s' dot.op PP(X in {s', -s'}) \
    = sum_(s' in RR_(>=0)) s' dot.op s' (PP(X=s')+PP(X=-s')) = sum_(s' in RR_(>=0)) s' dot.op s' PP(X=s')+sum_(s' in RR_(<0)) s' dot.op s' PP(X=s') \
    = sum_(s' in RR_(>=0)) abs(s') abs(s'PP(X=s'))=sum_(s' in RR_(<0)) abs(s') abs(s'PP(X=s')) = sum_(s' in RR) abs(s') dot.op abs(s' PP(X=s')) = sum_(s in supp(X)) abs(s) dot.op abs(s PP(X=s))
  $
  זהו טור מתכנס בהחלט ולכן ממבחן ההתכנסות גם $ sum_(s in S) abs(s PP(X=s)) $
  הוא טור מתכנס.
]

#subquestion()
נפריך את הטענה שאם  $X,Y$ משתנים מקריים כך ש־$EE(X)=EE(Y)$ וכן $EE(X^2)=EE(Y^2)$  אז $PP(X=Y)=1$.

#proof[
  נסתכל על $Omega=[4]^2$ מרחב ההטלה של שתי קוביות הוגנות בעלות $4$ פאות.\
  נגדיר $X((omega_1, omega_2)) = omega_1$ וכן $Y((omega_1, omega_2))=omega_2$.\
  ואכן, $X,Y ~ U([4])$ ולכן $EE(X)=EE(Y)$ וגם $EE(X^2)=EE(Y^2)$ אבל $PP(X=Y)=1/4 != 1$.
]

#subquestion()
נפריך את הטענה שקיים משתנה מקרי בדיד $X$ אי־שלילי בעל תוחלת סופית כך שמתקיים
$ exists N in NN, forall n >= N, PP(X>=n)=EE(X)/n $

#proof[
  נניח בשלילה שאכן קיים משתנה מקרי כזה ויהי ה־$N$ המדובר,  אז לכל $n>N$ מתקיים $PP(X>=n)=EE(X)/n$ ולכן
  $
    EE(X)=sum_(n=1)^infinity n PP(X=n) =_((star)) sum_(n=1)^infinity PP(X>=n)=sum_(n=1)^(N-1) PP(X>=n) + sum_(n=N)^infinity PP(X>=n) = sum_(n=1)^(N-1) PP(X>=n) + sum_(n=N)^infinity EE(X)/n
  $
  כאשר $(star)$ נובע מנוסחת הזנב לחישוב תוחלת של משתנה מקרי הנתמך על הטבעיים..\
  נבחין $sum_(n=1)^(N-1) PP(X>=n) in RR$ כי זהו סכום סופי של ערכים הקטנים/שווים לאחד מהגדרת פונקציות ההסתברות, אך מצד שני הסכום מצד ימין מתבדר כי הוא לא אחר מאשר כפולה של הטור ההרמוני שמתבדר, ולכן התוחלת מתבדרת ובפרט לא סופית ולכן סתירה.
]

#question()
בוחרים באקראי באופן אחיד נקודה בקבוצה ${(i,j) bar i, j in [10], 1<=i<=j<=10}$ ונגדיר $X(i,j)=i, Y(i,j)=j$, משתנים מקריים.

#subquestion()
נחשב את ההתפלגות השולית של $X,Y$

#solution[
  ראשית נסמן
  $ S colon.eq {(i,j) bar i, j in [10], 1<=i<=j<=10} $
  עלינו לחשב תחילה את $abs(S)$: כל $i,j$ אם קיבענו $j$ אז $i$ יכול לקבל ערכים מ־$1$ עד $j$ ומספר הזוגות בהם $j$  הוא הקורדינאטה השנייה הוא בידיוק $j$, כלומר
  $ abs(S) = sum_(j=1)^10 j = (10 dot.op 11)/2 = 55 $
  וכן
  $ PP(Y=j)=j/55 space (j in {1, dots.h, 10}) $
  נקבע $i$, אז מהיות $i<=j<=10$ ייתכן כי $j in {i, i+1, dots.h, 10}$ כלומר $hash j = 10-i+1 = 11-i$ ולכן
  $ PP(X=i) = (11-i)/55, space (i in {1, dots.h, 10}) $
]

#subquestion()
נחשב את התוחלת של $X$.

#solution[
  לפי מה שמצאנו בסעיף הקודם והגדרת התוחלת
  $
    EE(X) = sum_(i in supp(X)) i PP(X=i) = sum_(i=1)^10 i PP(X=i) = sum_(i=1)^10 i (11-i)/55 = 1/55 sum_(i=1)^10 (11i-i^2) = 220/55 = 4
  $
]

#question()
מטילים קובייה פעם אחר פעם ועוצרים כאשר התקבל בפעם הראשונה $5$ או $6$.\
יהי $X$ מספר ההטלות הכולל עד העצירה ויהי $Y$ מספר המופעים של $1$ ו־$2$ בסדרת ההטלות.

#subquestion()
נמצא את ההתפלגות של $X$ ושל $Y bar {X=n}$  עבור $n>=1$.

#solution[
  ראשית, מהיות הקובייה הוגנת ההסתברות לקבל הטלה שמובילה לסיום המשחק היא $p=1/3$.\
  במילים אחרות, אנחנו מבצעים את ההטלות עד שנקבל הצלחה (שקול לזה שקיבלנו $5$ או $6$) כאשר הצלחה אינה תלויה בתוצאות הניסויים הקודמים: זהו משתנה מקרי גיאומטרי! אז עבור $k in NN$
  $ PP(X=k)=(1-p)^(k-1) p = (2/3)^(1-p) (1/3) $
  כלומר $X~Geo(1/3)$.\
  כעת, המאורע ${X=n}$ אומר שהטלות $1, dots.h, n-1$ הסתיימו בכישלון (קרי תוצאת ההטלה היא בין $1$ ל־$4$) ובהטלה ה־$n$ יצא לנו $5$ או $6$.\
  כדי לתרום לערכים של $Y$ צריך שתוצאת ההטלה שאנחנו מתנים עליה תהיה $1$ או $2$, כאשר אנחנו יודעים שלא ייתכן שיצא $5$ או $6$ בהטלות עד $n-1$, ולכן בהטלות הללו יש הסתברות אחידה של $1/4$ לקבל את אחד מהערכים ${1,2,3,4}$, נחשב את ההסתברות המותנית אם כך (נסמן $k$ תוצאת ההטלה לקריאות)
  $
    PP(k in {1,2} bar k in {1,2,3,4})=PP(k in {1,2})/PP(k in {1,2,3,4})=(2/6)/(4/6) = 1/2 ==> Y bar {X=n} ~ Bin(n-1, 1/2)
  $
  (יש לנו $n-1$ הטלות כי רק בהן יכול לצאת $1$ או $2$).
]

#subquestion()
נחשב את התוחלת של $Y$.

#solution[
  נשתמש בנוסחת התוחלת המותנית השלמה.\
  מהיות $Y bar {X=n} ~ Bin(n-1, 1/2)$ מתוחלת משתנה מקרי בינומי
  $ EE(Y bar {X=n})=(n-1)/2 $
  ומנוסחת התוחלת השלמה עבור הסתברות מותנית
  $
    EE(Y)=sum_(n=1)^infinity EE(Y bar X=n)PP(X=n) = sum_(n=1)^infinity (n-1)/2 (2/3)^(n-1) (1/3) = 1/6 sum_(n=1)^infinity (n-1)(2/3)^(n-1)
  $
  ראשית נבחין כי $sum_(n=1)^infinity (n-1) (2/3)^(n-1)$ זה טור הנגזרות של טור הנדסי, שאותו אנחנו יודעים לחשב:
  $
    sum_(n=1)^infinity (n-1)(2/3)^(n-1) =_(k=n-1 \
    x = 2/3) sum_(k=0)^infinity k x^k = 1/(1-x)
  $
  זה מתכנס במידה שווה ולכן אפשר לגזור איבר איבר ולקבל
  $ sum_(k=1)^infinity k x^(k-1) = 1/(1-x)^2 $
  ולכן נכפול שוב ב־$x$ כדי לחזור לסכום המקורי ונקבל
  $
    sum_(k=1)^infinity k x^k = x/(1-x)^2 ==>_(x=2/3) (2/3)/(1-2/3)^2 = (2/3)/(1/3)^2 = 18/3 = 6 \
    ==> EE(Y)= sum_(n=1)^infinity EE(Y bar X=n)PP(X=n) = 1/6 dot.op 6 = 1
  $
]

#subquestion()
נמצא $k in NN$ עבורו המאורע ${Y<k}$ מתרחש בהסתברות של לפחות $2/3$.

#solution[
  נרצה להשתמש באי־שיוויון מרקוב, עבור $k>0$ מתקיים
  $ PP(Y>=k)<=EE(Y)/k $
  ולכן עם תוצאות הסעיפים הקודמים
  $ PP(Y>=k)<=1/k $
  אז אנחנו רוצים $k$ עבורו $PP(Y>=k)<=1/3$
  $ PP(Y<k) = 1 - PP(Y>=k) $
  כאשר מהננחה, אנחנו מחפשים $PP(Y<k)>=2/3$ ולכן אנחנו מחפשים $k$ עבורו  $PP(Y>=k)<=1/3$ ולכן
  $ 1/k <= 1/3 <==> k>=3 $
  ולכן $k=3$ מספיק.
]

#subquestion()
נחשב את $EE(X bar Y=0)$ ולהסביר מדוע תוחלת זו אינה שווה לתוחלת משתנה מקרי גיאומטרי בעל סיכוי הצלחה $1/2$.
#solution[
  ראשית נבחין שהמאורע שאנחנו מדברים עליו אומר שב־ $n-1$ הטלות הראשונות תוצאת ההטלה היא רק $3$ או $4$ ובהטלה ה־$n$ קיבלנו $5$ או $6$, כאשר כל ההטלות הן בלתי־תלויות, כלומר
  $ PP(X=n, Y=0) = (1/3)^(n-1) dot.op (1/3) = (1/3)^n $
  מנוסחת ההסתברות השלמה
  $ PP(Y=0) = sum_(n=1)^infinity PP(X=n, Y=0)= sum_(n=1)^infinity (1/3)^n =_"טור הנדסי" (1/3)/(1-(1/3))=1/2 $
  ולכן
  $ PP(X=n bar Y=0) = PP(X=n, Y=0)/PP(Y=0) = (1/3)^n/(1/2)=2 dot.op 1/3^n = 2/3 dot.op (1/3)^(n-1) $
  כאשר את המעבר האחרון עשינו כדי לכתוב את ההסתברות בדומה למשתנה מקרי שמתפלג גיאומטרית עם פרמטר $q=2/3$ להצלחה, ולכן מהגדרת התוחלת למשתנה מקרי שמתפלג גיאומטרי
  $ EE(X bar Y=0)=1/q = 1/(2/3) = 3/2 $
  נסביר מדוע תוחלת זו אינה שווה לתוחלת של משתנה מקרי גיאומטרי בעל סיכוי הצלחה $1/2$: זאת מכיוון שהתנינו שאף אחת מההטלות אינה $1$ או $2$, ולכן מרכז המסה של ההטלות מכריח שהמשחק יהיה יותר קצר כדי ולכן נצטרך בממוצע לבצע פחות הטלות ולכן יש הסתברות גבוהה יותר לסיום מהיר יותר (שכן, תוחלת של משתנה מקרי מתפלג גיאומטרית עם פרמטר $1/2$ היא $2$, כלומר סיימנו את המשחק בממוצע מהר יותר).
]

#question()
$N$ יצרנים מתחרים בעמידות הנורות שהם מפיקים. הנורות של כולם שקולות ובכל יום כל אחת מהן עלולה להישרף בהסתברות של $1-p$.\
כל יצרן מקבל $3$ נקודות על כל נורה של יצרן אחר שהחזיקה פחות ימים משלו ובמקרה של תיקו אף אחד משני היצרנים לא מקבל נקודות.

#subquestion()
נחשב מהי תוחלת כמות הנקודות שמתקבלת על־ידי כל היצרנים.

#solution[
  נגדיר תחילה $X_i$ להיות המשתנה של כמות הימים שהנורה של היצרן ה־$i$ שרדה לפני שנשרפה.\
  מהנתון, נובע כי $PP(X_i = k)=(1-p) p^(k-1)$ (ההסתברות לשריפה היא $1-p$).\
  לכל $i!=j$, $X_i > X_j$ גורר שהיוצר ה־$i$ יקבל $3$ נקודות ובתיקו לא מקבל כלום, אז נגדיר את $S = 3 sum_(i!=j) bb(1)_({X_i > X_j})$.\
  נשתמש בלינארית התוחלת ונקבל
  $ EE(S)=3 dot.op N(N-1)PP(X_1 > X_2) $
  מהיות המאורעות בלתי־תלויים מהנתון מתקיים
  $
    PP(X_1 > X_2) = sum_(k>=1) PP(X_2=k)PP(X_1 > k) = sum_(k>=1) (1-p) p^(k-1) p^k = sum_(k>=1) (1-p)p^(2k-1)=_"טור גיאומטרי" ((1-p)p)/(1-p^2)=p/(1+p)
  $
  כלומר
  $ EE(S)= (3 dot.op N(N-1) dot.op p)/(1+p) $
]

#subquestion()
נחסום מלמעלה את ההסתברות שביום האחרון תישרפנה ביחד שתי נורות בידיוק.\
_הערה_: אוהד אמר שמספיק לחסום מלמעלה.

#solution[
  נקבע $m>=1$ ונסתכל על המאורע שאומר שבידיוק שתי נורות הגיעו ליום ה־$m$ והשאר נשרפו, כלומר
  $ binom(N, 2) (PP(X=m))^2 PP(X<m)^(N-2)= binom(N, 2) (1-p)^2 p^(2(m-1)) (1-p^(m-1))^(N-2) $
  נסמן $r=m-1$ ולכן
  $ P = binom(N, 2) (1-p)^2 sum_(r=0)^infinity p^(2r) (1-p^r)^(N-2) $
  מתקיים $(1-p^r)^(N-2)<=1$ שכן $p in [0,1]$ ולכן
  $ P <= binom(N, 2) (1-p)^2 sum_(r=0)^infinity p^(2r) = binom(N, 2) (1-p)^2 dot.op 1/(1-p^2) = (1-p)/(1+p) $
]

#question()
תהיי ${A_n bar n in NN}$ משפחה בת־מנייה של מאורעות במרחב הסתברות $(Omega,2^Omega, PP)$.

#subquestion()
עבור כל $N in NN$ נבטא את המאורע $union.big_(n=1)^N A_n$ כמאורע המתואר על־ידי משתנה מקרי $X$ המוגדר כסכום המשתנים המקריים $X = sum_(n=1)^N bb(1)_(A_n)$.

#solution[
  עבור $N$ מקובע, $X(omega)$ סוכם כמה מאורעות מתוך $A_1, dots.h, A_N$ מתרחשים.\
  המאורע $union.big_(n=1)^N A_n$ אומר שלפחות אחד מתוך $A_1, dots.h, A_N$ קורה (מהגדרת האיחוד), כלומר
  $ union.big_(n=1)^N A_n = { omega in Omega bar X(omega)>=1} = {X>=1} $
]

#subquestion()
נשתמש באי־שיוויון מרקוב ובלינאריות התוחלת כדי להוכיח מחדש את חסם האיחוד (אי־שיוויון בול) עבור איחודים סופיים.

#proof[
  נשתמש במשתנה המקרי $X = sum_(i=1)^N bb(1)_(A_n)$, זהו משתנה מקרי אי־שלילי ומהסעיף הקודם $union.big_(n=1)^N A_n = {X>=1}$.\
  מאי־שיוויון מרקוב עבור $a=1$ נקבל
  $ PP(union.big_(n=1)^N A_n) = PP(X>=1) <= EE(X)/1 = EE(X) $
  אבל מלינאריות התוחלת
  $ EE(X) = EE(sum_(i=1)^N bb(1)_(A_n)) = sum_(i=1)^N EE(bb(1)_(A_n)) = sum_(i=1)^N PP(A_n) $
  כאשר המעבר האחרון נובע מהיות התומך של פונקציה מציינת $0$ או $1$ ו־$0$ לא תורם כלום.\
  כלומר
  $ PP(union.big_(n=1)^N A_n)<=sum_(i=1)^N PP(A_n) $
]

#question()
מטילים מטבע הוגן $n$ פעמים, נחשב את תוחלת מספר הרצפים של התוצאה עץ.

#solution[
  המטבע הוגן ולכן יש לנו הסתברות $1/2$ לקבל עץ ויהיו $X_1, dots.h, X_n$  כאשר $X_i$ הוא תוצאת ההטלה ה־$i$.\
  נגדיר את האינדיקטור $I_k$ להיות $1$ כאשר רצף של עצים התחיל בהטלה ה־$k$ כאשר רצף מתחיל אם ורק אם $X_k$ הוא עץ ואו ש־$k=1$ או ש־$X_(k-1)$ זה פלי.\
  ראשית נשים לב $EE(I_1) = PP(X_1 = H)=1/2$ ועבור $k>=2$ אנחנו מחפשים בעצם
  $ EE(I_k) = PP(X_(k-1) = T, X_k = H)=_"ההטלות בלתי־תלויות" 1/4 $
  כאשר התוחלות הללו נובעות מתוחלת משתנה מקרי מתפלג ברנולי.\
  נגדיר $I = sum_(k=1)^n I_k$ ונקבל עם לינאריות התוחלת
  $ EE(I) = EE(I_1) + sum_(k=2)^n EE(I_k) = 1/2 + (n-1)/4 = (n+1)/4 $
]
