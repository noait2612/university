#import "../../../src/article.typ": *
#show: article.with(
  title: [ פתרון מטלה 02 --- תורת ההסתברות 1, 80420 ],
  signature: [#align(center)[#image("../../../src/duck.png", width: 30%, fit: "contain")]],
)

#show regex("\p{Hebrew}.+"): it => text(
  dir: rtl,
  font: "Libertinus Serif",
  lang: "he",
)[#it] // Dark Magic: https://github.com/typst/typst/issues/3695
#set math.cases(gap: 1em)

#question()
כל אחד מבין $n$ אנשים נולד ביום מקרי בשנה בת $m$ ימים.\
נסמן ב־$A_(n,m)$ את המאורע שלפחות לשניים יש ימי־הולדת באותו היום.\
נמצא פונקציה $f(m)$ כך שעבור $n = o(f(m))$ כלומר $display(lim_(n arrow.r infinity) n/(f(m)) = 0)$ ומתקיים
$ lim_(n arrow.r infinity) PP(A_(n,m)) = 0 $
ואילו עבור $n = omega(f(m))$ כלומר $lim_(m arrow.r infinity) f(m)/n = 0$ מתקיים
$ lim_(m arrow.r infinity) PP(A_(n,m)) = 1 $

#solution[
  נסמן ב־$overline(PP(A_(n,m)))$ את המאורע המשלים שבו אף שני אנשים לא חוגגים יום־הולדת משותף, בעצם בין כל אדם יש התאמה חד־חד ערכית ליום בשנה, וזו בעצם תמורה, ולפי בעיית המנייה ה־2 אנחנו יודעים שמתקיים שמספר הדרכים תהיינה
  $ overline(PP(A_(n,m))) = (m dot.op (m-1) dot.op (m-2) dots.h.c (m-n+1))/m^n = product_(k=1)^(n-1) (1-k/m) $
  מהגדרת המשלים אנחנו מחפשים תנאים על $n$ שיגרום לכך ש־$overline(PP(A_(n,m))) arrow.r 1$ כאשר $m arrow.r infinity$.\
  כשיש לנו מכפלות אנחנו אוהבים לעשות $ln$ על שני האגפים
  $ ln(overline(PP(A_(n,m)))) = ln(product_(k=1)^(n-1) (1-k/m)) =_"חוקי לוגריתמים" sum_(k=1)^(n-1) ln(1-k/m) $
  אנחנו יודעים את הקירוב $ln(1-x) approx -x$ ובמקרה שלנו אנחנו יכולים לעשות את הקירוב כאשר $k$ קטן באופן יחסי ביחס ל־$m$, אז
  $ sum_(k=1)^(n-1) ln(1-k/m) approx sum_(k=1)^(n-1) (-k/m) = -1/m sum_(k=1)^(n-1) k = -(n(n-1))/(2m) approx -n^2/(2m) $
  כלומר
  $ overline(PP(A_(n,m))) approx e^(-n^2/(2m)) $
  כעת, כדי ש־$P(A_(n,m)) arrow.r 0$ צריך $overline(PP(A_(n,m))) arrow.r 1$, כלומר  $e^(-n^2/(2m)) arrow.r 1$ אז
  $ n^2/(2m) arrow.r 0 ==> n^2/m arrow.r 0 $
  כלומר, $n^2/m$ גדל *לאט יותר* מאשר $m$ או ש־$n=o(sqrt(m))$ (אנחנו משאיפים את $m$).\
  אנחנו רוצים $n=o(f(m))$ ולכן $f(m) = sqrt(m)$.\
  עבור המקרה בו $P(A_(n,m)) arrow.r 1$ אנחנו צריכים $overline(PP(A_(n,m))) arrow.r 0$, כלומר  $e^(-n^2/(2m)) arrow.r 0$ וזה קורה כאשר $exp arrow.r infinity$, כלומר
  $ n^2/(2m) arrow.r infinity ==> n^2/m arrow.r infinity $
  וזה קורה אם $n^2$ גדל *מהר יותר* מ־$m$ או כאשר $n=omega(sqrt(m))$, אבל בגלל התנאי $n = omega(f(m))$ נקבל ש־$f(m)=sqrt(m)$.
]

#question()
על שולחן שני מטבעות – אחד הוגן ואחד מזוייף שמוציא תוצאת עץ בסיכוי $3/4$.\
עורכים את שלושת הניסויים הבאים:
+ מטילים פעם אחת מטבע שנבחר באקראי ובפעם השנייה את השני
+ מטילים פעם אחת מטבע שנבחר באקראי ואז משיבים אותו ומטילים שוב מטבע שיצא באקראי
+ בוחרים מטבע באקראי ומטילים אותו פעמיים
נסמן $L_1 = ([0,1], cal(F), PP_1)$ מרחב ההסתברות המתאים לניסוי ברנולי $1/2$ ו־$L_2 = ([0,1], cal(F), PP_2)$ מרחב ההסתברות המתאים לניסוי ברנולי $3/4$ (כלומר למטבע ההוגן והלא הוגן בהתאמה).

#subquestion()
נראה כי את כל הניסויים הללו ניתן לתאר במרחב המכפלה $(L_1)^4 times (L_2)^2$, כלומר כל תוצאה של הניסוי מתאימה למאורע במרחב זה.

#proof[
  אני לא חושבת שהשאלה נכונה בכלל. #todo.
]

#subquestion()
נחשב מה ההסתברות לקבל לפחות פעם אחת עץ בכל אחד מהניסויים.

#solution[
  אנחנו רוצים לחשב את ההסתברות של *לפחות* פעם אחת עץ בכל אחד מהניסויים – זה אומר לקבל פעמיים עץ או בהטלה הראשונה עץ או בהטלה השנייה עץ.\
  + לקבל פעמיים עץ
    + בניסוי הראשון
      $ 1/2 dot.op 3/4 dot.op 1/2 + 1/2 dot.op 1/2 dot.op 3/4 = 3/8 $
    + בניסוי השני
      $
        (underbrace(1/2 dot.op 3/4, "בקבלת מטבע מוטה") + underbrace(1/2 dot.op 1/2, "בקבלת מטבע הוגן"))^overbrace(2, "חוזרים על הניסוי פעמיים") = 25/64
      $
    + בניסוי השלישי
      $
        underbrace(1/2 dot.op (3/4)^2, "שבהטלה יצא לנו מטבע מוטה") dot.op underbrace(1/2 dot.op (1/2)^2, "שבהטלה יצא לנו מטבע הוגן") = 13/32
      $
  + בהטלה הראשונה אנחנו רוצים עץ ובשנייה אנחנו רוצים פלי
    + בניסוי הראשון
      $ 1/2 dot.op 3/4 dot.op 1/2 + 1/2 dot.op 1/2 dot.op 1/4 = 1/4 $
    + בניסוי השני – בהתאם לסדר הנסכמים:\
      בחרנו מטבע הוגן הטלנו עץ בחרנו שוב מטבע הוגן וקיבלנו פלי, בחרנו מטבע הוגן, הטלה עץ, בחרנו מטבע לא הוגן וקיבלנו פלי, בחרנו מטבע לא הוגן, הטלנו עץ, בחרנו מטבע לא הוגן וקיבלנו פלי ובחרתי מטבע לא הוגן, קיבלתי עץ, בחרתי מטבע הוגן, קיבלתי פלי
    $
      1/2 dot.op 1/2 dot.op 1/2 dot.op 1/2 + 1/2 dot.op 1/2 dot.op 1/2 dot.op 1/4 + 1/2 dot.op 3/4 dot.op 1/2 dot.op 1/4 + 1/2 dot.op 3/4 dot.op 1/2 dot.op 1/4 = 15/64
    $
    + בניסוי השלישי – פעם אחת בחרתי מטבע הוגן והטלתי פעמיים, פעם שנייה בחרתי מטבע לא הוגן והטלתי פעמיים
    $ 1/2 dot.op 1/2 dot.op 1/2 + 1/2 dot.op 3/4 dot.op 1/4 = 7/32 $
  + לקבל עץ בהטלה השנייה – נשים לב שזה מקרה סימטרי בכל אחד מהניסויים למקרה הקודם רק שפה "סדר" המכפלה משתנה
  נחבר לכל ניסוי את כלל המקרים שלו ונסכם:
  + ההסתברות לקבל לפחות פעם אחת עץ בניסוי הראשון היא $7/8$
  + ההסתברות לקבל לפחות פעם אחת עץ בניסוי השני היא $55/64$
  + ההסתברות לקבל לפחות פעם אחץ עץ בניסוי השלישי היא $27/32$
]

#question()
אם בוחרים ילד מקרי בתיכון "ברייקבילס" סיכוייו להיות בחוג אומנות הם $10%$, בחוט לבלט $20%$ ובחוג גננות הוא $30%$.\
נראה שבבחירת ילד מקרי ההסתברות שהוא מצוי בשני חוגים לפחות היא לכל היותר $30%$.

#proof[
  ראשית, לא משנה איזה צמד של חוגים נבחר בגלל שאנחנו מחפשים צמד של שני חוגים מבין שלושה, בכל קומבינציה נקבל לפחות חוג אחד שהילד נמצא בו (אם לקחנו ילד שנמצא בשני חוגים).\
  אז נסמן ב־$E$ את קבוצת הילדים שנמצאים בשני חוגים, $A$ ילדים בחוג לגננות ו־$B$ ילדים בחוג לבלט ולכן $E subset.eq A union B$ ולכן
  $ PP(E) <=_("מונוטוניות") PP(A union B) <=_"חסם האיחוד" PP(A) + PP(B) $
]

#question()
יהי $m in NN$. נבחן באקראי סדרה של $n_m >=7$ מספרים מתוך קבוצה $[m]$ עם חזרות (ומכיוון שזו סדרה, גם עם חשיבות לסדר).\
נסמן ב־$p_m$ את ההסתברות שבסדרה שבחרנו מופיע אותו איבר $7$ פעמים.\
נראה באמצעות חסם האיחוד כי עבור $n_m = o(m^(6/7))$ כלומר $lim_(m arrow.r infinity) n_m/m^(6/7) = 0$ מתקיים $lim_(m arrow.r infinity) p_m = 0$.

#proof[
  ראשית $Omega = [m]^n$ ואנחנו בהסתברות אחידה לפי הנתון ולכן $p(omega)=1/m^n$.\
  יהי $A_i$ עבור $i in [m]$ המאורע ש־$i$ מופיע לפחות $7$ פעמים, אז מתקיים
  $ abs(A_i) = m^n - (sum_(k=0)^6 binom(n, k) (m-1)^(n-k)) $
  נגדיר $A = union.big_(i in [m]) A_i$ המאורע שיש לפחות שבעה מופעים לאחד המספרים ומחסם האיחוד
  $ p_m = PP(A)=PP(union.big_(i in [m]) A_i) <= sum_(i in [m]) PP(A_i) = m dot.op abs(A_i)/abs(Omega) $
  אז
  $
    p_m <= m dot.op 1/m^n (m^n - (sum_(k=0)^6 binom(n, k) (m-1)^(n-k))) = 1/m^(n-1) (m^n - (sum_(k=0)^6 binom(n, k) (m-1)^(n-k))) \
    = m - (sum_(k=0)^6 binom(n, k) ((m-1)^(n-k))/(m^(n-1)))
  $
  לפתוח את הסכום יהיה ארוך ומבלבל, אז נשים לב שעבור $k in {0, dots.h, 6}$ מתקיים
  $
    binom(n, k) ((m-1)^(n-k))/(m^(n-1)) = binom(n, k) ((m(1-1/m))^(n-k))/(m^(n-1)) = binom(n, k) (m^(n-k)(1-1/m)^(n-k))/(m^(n-1)) = binom(n, k) m^((n-k)-(n-1))(1-1/m)^(n-k) \
    = binom(n, k) m^(1-k)(1-1/m)^(n-k) = binom(n, k) (1-1/m)^(n-k)/(m^(k-1))
  $
  נניח כי $n_m = o(m^(6/7))$ (זו הנחה הכרחית לקיום הגבול הרצוי) ולכן $n arrow.r infinity$ גורר $m arrow.r infinity$ ומתקיים
  $ 0<=lim_(m arrow.r infinity) p_m <= lim_(m arrow.r infinity) m-(sum_(k=0)^6 binom(n, k) (1-1/m)^(n-k)/(m^(k-1))) $
  אבל מההנחה, $(1-1/m)^(n-k) arrow.r 1$ ולכן כל הביטוי שואף ל־$0$.
]

#question()
בכל בוקר ילד מקבל מהוריו סכום קבוע לקנות חטיף. בכל חטיף נמצאת אות אחת מ־$22$ אותיות בהסתברות שווה ועל הילד להרכיב את המילה "עוגה".

#subquestion()
עבור $n in NN$, נחשב את ההסתברות שביום ה־$n$ לילד לא הייתה את האות $a$ עבור $a in {"ה", "ג", "ו", "ע"}$.

#solution[
  נסמן $Omega = {"ת", dots.h, "א"}^n = 22^n$ עם $n$ חזרות ואנחנו מחפשים את המאורע
  $ A = {(x_1, dots.h, x_n) bar forall i in [n], x_i in.not {"ה", "ג", "ו", "ע"}} $
  ולכן מהגדרת ההסתברות האחידה
  $ PP(A) = abs(A)/abs(Omega) = (21/22)^n $
  במילים פשוטות: מרחב המדגם הוא כל המילים שאפשרי היה לקבל במהלך $n$ הימים, כלומר אלה אוסף כל המילים (עם $22$ אותיות) מגודל $n$.\
  יש $22^n$ כאלו ואנחנו שואלים מה ההסתברות שהמילה שיש לנו היא ללא אחת האותיות, כלומר שהיא מורכבת רק מ־$21$ האותיות הנותרות ויש בידיוק $21^n$ כאלו.
]

#subquestion()
נחשב את ההסתברות שלאחר $n$ ימים הילד עדיין לא הצליח להרכיב את המילה "עוגה".

#solution[
  אנחנו צריכים נוסחת הכלה והדחה מסדר רביעי כי יש לנו ארבע אותיות שפוטנציאלית חסרות.\
  נגיד $A,B,C,D$ המאורע שלילד אין את האותיות הראשונה, השנייה, השלישית והרביעית בהתאמה לאחר $n$ ימים, אז
  $
    PP(A union B union C union D) = PP(A) + PP(B) + PP(C) + PP(D) \
    - PP(A inter B) - PP(A inter C) - PP(A inter D) - PP(B inter C) - PP(B inter D) - PP(C inter D) \
    + PP(A inter B inter C) + PP(A inter B inter D) + PP(A inter C inter D) + PP(B inter C inter D) \
    - PP(A inter B inter C inter D)
  $
  אבל אנחנו בהסתברות אחידה ולכן
  $ PP(A union B union C union D) = 4 PP(A) - 6 PP(A inter B) + 4PP(A inter B inter C)-PP(A inter B inter C inter D) $
  בסעיף א' מצאנו $ PP(A) = (21/22)^n $
  ובאותו אופן חישוב נקבל גם עבור החיתוכים
  $
    PP(A inter B) = (20/22)^n, space PP(A inter B inter C) = (19/22)^n, space PP(A inter B inter C inter D) = (18/22)^n
  $
  ולכן
  $
    PP(A union B union C union D) = 4 PP(A) - 6 PP(A inter B) + 4PP(A inter B inter C)-PP(A inter B inter C inter D) \
    = 4 (21/22)^n - 6 (20/22)^n + 4 (19/22)^n - (18/22)^n
  $
]

#pagebreak()

#subquestion()
כעת נניח שאביו המתמטיקאי של הילד ביקש ממנו להרכיב את המילה "אטא". נחשב מה ההסתברות שלאחר $n$ ימים הילד עדיין לא הצליח להרכיב את המילה "אטא".

#solution[
  נסמן ב־$A$ את המאורע שהילד אסף את האותיות הנחוצות בשביל המילה, יהיה לנו יותר פשוט לחשב הפעם את $PP(A^c)$ – המאורע שבו הילד לא הצליח להרכיב את המילה – כלומר אחד משלושה מצבים קורים: או שאין לו את האות ט', או שיש לו אפס פעמיים א' או פעם אחת א'.\
  נבחין שהמאורעות הללו לא בלתי־תלויים ולכן נהיה חייבים להשתתמש בהכלה והדחה שוב.\
  לנוחות, נסמן את המאורע הראשון ב־$A_1$ ואת השניים האחרים נכלול באותו אחד ונסמנם $A_2$.\
  מהסעיף הקודם אנחנו יודעים שמתקיים $PP(A_1) = (21/22)^n$.\
  עבור המקרה השני, אם אין בכלל אלפים אז זה שוב כמו המקרה הקודם, ואם יש א' אחד אז יש לנו $binom(n, 1)$ אפשרויות למקומו בסדר הימים ואת שאר \
  ה־$n-1$ ימים יש לנו $21$ אפשרויות לאותיות בידיוק. המאורעות הללו כן זרים, ולכן
  $ PP(A_2) = (21/22)^n + (n dot.op 21^(n-1))/22 = (21^n+n dot.op 21^(n-1))/22^n $
  נשאר לבחון את ההסתברות של החיתוך שלהם כדי שנוכל להשתמש בעיקרון ההכלה וההדחה.\
  גם פה יש לנו שני מקרים: או שאין בכלל ט' וא', או שיש אפס ט' ופעם אחת א'.\
  במקרה הראשון החישוב דומה למקודם ולכן יש $(20/22)^n$ אפשרויות כאלו, המקרה השני דומה לחלק השני של החישוב ממקודם:\
  יש לנו $binom(n, 1)=n$ אפשרויות לבחירת מקום של א', ולשאר יש הפעם $20$ אפשרויות בלבד כי אין ט', אז
  $ PP(A_1 inter A_2) = (20^n+n dot.op 2^(n-1))/22^n $
  אז בסך־הכל
  $
    PP(A^c) = PP(A_1) + PP(A_2) - PP(A_1 inter A_2) = (21/22)^n + (21^n+n dot.op 21^(n-1))/22^n - (20^n+n dot.op 2^(n-1))/22^n
  $
]

#question()
מגרילים פעמיים מספר טבעי לפי התפלגות נקודתית $p(n)=theta(1-theta)^(n-1)$ עבור $0<theta<1$.\
נחשב מהי ההסתברות שהתוצאה בהגרלה השנייה תהיה גדולה/שווה לתוצאה בהגרלה הראשונה.

#solution[
  נסמן ב־$X$ את ההטלה הראשונה וב־$Y$ את ההטלה השנייה ומתקיים $ PP(X=n)=PP(Y=n)= theta(1-theta)^(n-1) $
  אנחנו רוצים את ההסתברות שהתוצאה בהגרלה השנייה תהיה גדולה/שווה לתוצאה בהגרלה הראשונה, כלומר בהינתן שיצא $PP(X=k)$ עבור $k in NN$, אנחנו רוצים $PP(Y>=X)$ זה בעצם שקול ללכתוב $PP(Y>=k "and" X=k)$, אבל נבחין ששתי ההטלות הן *בלתי־תלויות* ולכן
  $ PP(Y>=k "and" X = k) = PP(X=k)PP(Y>=k) $
  אנחנו רוצים זאת לכל $k in NN$ ולכן נרצה לחשוב את הסכום
  $ PP(Y>=X) = sum_(k=1)^infinity PP(X=k)PP(Y>=k) $
  ראשית נשים לב שמתקיים
  $
    PP(Y>=k) = sum_(n=k)^infinity PP(Y=k) = sum_(n=k)^infinity theta(1-theta)^(n-1) = theta(1-theta)^(k-1) sum_(n=0)^infinity (1-theta)^n =_"טור גיאומטרי" theta(1-theta)^(k-1) dot.op 1/theta = (1-theta)^(k-1)
  $
  ולכן
  $
    PP(Y>=X) = sum_(k=1)^infinity PP(X=k)PP(Y>=k) = sum_(k=1)^infinity theta(1-theta)^(n-1)theta(1-theta)^(n-1) = theta sum_(n=1)^infinity (1-theta)^(2k-2) \
    =_(m=k-1) theta sum_(m=0)^infinity (1-theta)^(2m) =_"טור גיאומטרי" theta dot.op 1/(1-(1-theta)^2) = theta/(theta(2-theta)) = 1/(2-theta)
  $
  אז ההסתברות בשאלה היא $1/(2-theta)$.
]

#question()
בוחרים סידור אקראי בשורה של $3$ כדורים אדומים, $5$ לבנים ו־$8$ שחורים. נחשב מהי ההסתברות ששני הקצוות יהיו באותו הצבע.

#solution[
  נסמן $n_1 = 3, n_2 = 5, n_3 = 8$. \
  אנחנו לא נמצאים בידיוק בהסתברות אחידה אלא בהסתברות אחידה פר צבע כדור בהתאם לנקודה בזמן שאנחנו נמצאים בה.\
  מה הכוונה? לכדור הראשון ההסתברות לבחור כדור בצבע ה־$i$ היא $PP(n_i) = n_i/16$, אבל כשנרצה לחשב את ההסתברות שעכשיו נשים בפינה השנייה את הכדור ה־$n_i$ ההסתברות תהיה $PP(n_i) = (n_i-1)/15$.\
  אז בעצם $ PP("הכדורים בקצוות הם באותו הצבע") = sum_(i=1)^3 (n_i)/16 dot.op (n_i-1)/15 = 1/240 sum_(i=1)^3 n_i (n_i-1) = 1/240 (3 dot.op 2 + 5 dot.op 4 + 8 dot.op 7) = 82/240 = 41/120 $
  נבחין שזה נובע מנוסחת ההסתברות השלמה כי אנחנו מחפשים $ PP("הכדורים בקצוות הם באותו הצבע") = PP("הכדורים בקצוות לבנים") + PP("הכדורים בקצוות שחורים") + PP("הכדורים בקצוות אדומים") $
  ובכל מקרה בנפרד יש לנו ניסוי דו־שלבי.
]

#question()
נתונות $n$ מגירות כאשר בכל אחת מהן יש שלושה כדורים כסופים וכדור אחד זהב.\
אנחנו עורכים ניסוי בעל $n+1$ שלבים: \
בשלב ה־$i<n+1$ נוציא כדור אחד אקראי מהמגירה ה־$i$ ונעביר למגירה ה־$i+1$ (אם $i=n$ נעביר למגירה הראשונה).\
אחרי שנסיים את כל השלבים הללו נחזור למצב שבו יש ארבעה כדורים בכל מגירה.\
בשלב ה־$n+1$ נשלוף כדור אקראי מהמגירה הראשונה.\
נחשב את ההסתברות שהכדור שנשלוף יהיה בצבע זהב.

#solution[
  נעשה באופן דומה לרעיון שאוהד אמר בהרצאה.\
  לפני תחילת הניסוי, מתקיים $PP("לשלוף כדור זהב") = 1/4, PP("לשלוף כדור כסף") = 3/4$.\
  נסמן ב־$D_i$ את סט הכדורים במגירה ה־$i$ לפני שעשינו את הצעד ה־$i$ של ההוצאה מהמגירה.\
  נסמן ב־$P_i ("הוצאנו זהב")$ את ההסתברות שבשלב ה־$i$ הוצאנו את הכדור הזהב, ואנחנו מחפשים את $P(n+1"הוצאנו זהב בשלב ה־")$.\
  יש לנו בסך־הכל $n$ כדורים זהובים ו־$3n$ כדורים כסופים כאשר לא מעניין אותנו מאיזו מגירה הכדור הזהב הגיע.\
  בתור התחלה, נסמן כדור זהב שרירותי ב־$G^star$. מהיות המערכת שלנו סימטרית (להכל יש את אותו שלב התחלה וגם בסוף יש את אותה כמות הכדורים ומכולם אנחנו מוציאים בצורה אחידה), אז לכל כדור במערכת יש הסתברות זהה להיות בין כל אחת מ־$n$ המגירות.\
  ולכן בעצם, $P(G^star "במגירה הראשונה") = 1/n$! \
  אז בעצם, אנחנו מחפשים
  $ P("שלפנו בסוף כדור זהב") = sum_(k=1)^n P(k"שלפנו כדור זהב במגירה ה־") $
  אבל בגלל הטיעון לעיל כל הכדורים הזהובים אותו הדבר אז אפשר להתייחס לזה בתור $G^star$ שאותו אנחנו יודעים לחשב עם נוסחת ההסתברות השלמה ועם מה שמצאנו
  $
    P(G^star" שלפנו את")= P(G^star" שלפנו את" bar G^star"במגירה הראשונה") dot.op P(G^star"במגירה הראשונה") = 1/4 dot.op 1/n
  $
  אבל יש לנו $n$ כדורים זהובים ששונים זה מזה ולכן
  $ P("שלפנו בסוף כדור זהב") = n dot.op P(G^star" שלפנו את") = n dot.op 1/(4n) = 1/4 $
  וזה מתיישר עם מה שאוהד אמר בהרצאה.
]
